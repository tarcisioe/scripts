#!/bin/bash

source scriptlib-init

require util


usage() {
echo "\
Usage: $(script-name) [OPTION...]
Play a Twitch stream (handle is fetched with dmenu).

Optional arguments:
    -h/--help    Print this help message and exit."
}


get-stream-handle() {
    dmenu -p "Enter twitch handle " <<< ""
}


runtwitch() {
    playlink "https://twitch.tv/$(get-stream-handle)"
}


main() (
    set -e

    local options
    options=$(getopt -o h -l help -- "$@")
    eval set -- "$options"

    while true; do
        case "$1" in
            -h|--help)
                usage && exit 0
                ;;
            --) shift ;&
            *) break ;;
        esac
        shift
    done

    runtwitch
)


main "$@"
